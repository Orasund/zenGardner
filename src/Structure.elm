module Structure exposing (..)

import Tile exposing (Obstacle(..), Tile(..))


fromEmojis : List String -> List ( ( Int, Int ), Tile )
fromEmojis rows =
    rows
        |> List.indexedMap
            (\y row ->
                row
                    |> String.toList
                    |> List.indexedMap
                        (\x char ->
                            char
                                |> fromEmoji
                                |> Maybe.map (Tuple.pair ( x, y ))
                        )
                    |> List.filterMap identity
            )
        |> List.concat


fromEmoji : Char -> Maybe Tile
fromEmoji char =
    case char of
        'ðŸª¨' ->
            Just (ObstacleTile Stone)

        'ðŸ•‹' ->
            Just (ObstacleTile Pole)

        'ðŸ‘£' ->
            Just Sand

        'ðŸŒ±' ->
            Just Gras

        'âŒ' ->
            Nothing

        _ ->
            Nothing


startingArea : List ( ( Int, Int ), Tile )
startingArea =
    [ "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£âŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒðŸ‘£ðŸ‘£ðŸŒ±ðŸŒ±ðŸŒ±ðŸ‘£ðŸ‘£âŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒðŸ‘£ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸ‘£âŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒðŸ‘£ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸ‘£âŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒðŸ‘£ðŸ‘£ðŸŒ±ðŸŒ±ðŸŒ±ðŸ‘£ðŸ‘£âŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£âŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    ]
        |> fromEmojis


grasArea : List ( ( Int, Int ), Tile )
grasArea =
    [ "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒâŒ"
    , "âŒâŒðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒâŒðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒ"
    , "âŒâŒðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±ðŸŒ±âŒâŒ"
    , "âŒâŒðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±âŒâŒ"
    , "âŒâŒâŒðŸŒ±âŒâŒâŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±âŒâŒ"
    , "âŒâŒâŒðŸŒ±âŒâŒâŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±âŒâŒ"
    , "âŒâŒâŒðŸŒ±âŒâŒâŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±âŒâŒ"
    , "âŒâŒâŒðŸŒ±âŒâŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±âŒâŒâŒ"
    , "âŒâŒðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒ"
    , "âŒâŒðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒâŒðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒâŒ"
    , "âŒâŒðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒ"
    , "âŒâŒâŒðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    ]
        |> fromEmojis


grasBatches : List ( ( Int, Int ), Tile )
grasBatches =
    [ "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒðŸŒ±âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒðŸŒ±âŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±âŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒ"
    , "âŒâŒâŒðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±âŒâŒâŒ"
    , "âŒâŒðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒâŒðŸŒ±ðŸŒ±âŒâŒâŒâŒ"
    , "âŒâŒðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    ]
        |> fromEmojis


poleArea : List ( ( Int, Int ), Tile )
poleArea =
    [ "ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£âŒâŒâŒâŒâŒâŒâŒ"
    , "ðŸ‘£ðŸ•‹ðŸ‘£ðŸ•‹ðŸ‘£ðŸ•‹ðŸ‘£ðŸ•‹ðŸ‘£âŒâŒâŒâŒâŒâŒâŒ"
    , "ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£âŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒðŸ‘£ðŸ‘£ðŸ‘£âŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒðŸ‘£ðŸ•‹ðŸ‘£âŒâŒ"
    , "âŒðŸ‘£ðŸ‘£ðŸ‘£âŒâŒâŒâŒâŒâŒâŒðŸ‘£ðŸ‘£ðŸ‘£âŒâŒ"
    , "âŒðŸ‘£ðŸ•‹ðŸ‘£âŒðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±âŒâŒðŸ‘£ðŸ•‹ðŸ‘£âŒâŒ"
    , "âŒðŸ‘£ðŸ‘£ðŸ‘£âŒðŸŒ±ðŸ•‹ðŸ•‹ðŸŒ±âŒâŒðŸ‘£ðŸ‘£ðŸ‘£âŒâŒ"
    , "âŒðŸ‘£ðŸ•‹ðŸ‘£âŒðŸŒ±ðŸ•‹ðŸ•‹ðŸŒ±âŒâŒðŸ‘£ðŸ•‹ðŸ‘£âŒâŒ"
    , "âŒðŸ‘£ðŸ‘£ðŸ‘£âŒðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±âŒâŒðŸ‘£ðŸ‘£ðŸ‘£âŒâŒ"
    , "âŒðŸ‘£ðŸ•‹ðŸ‘£âŒâŒâŒâŒâŒâŒâŒðŸ‘£ðŸ•‹ðŸ‘£âŒâŒ"
    , "âŒðŸ‘£ðŸ‘£ðŸ‘£âŒâŒâŒâŒâŒâŒâŒðŸ‘£ðŸ‘£ðŸ‘£âŒâŒ"
    , "âŒðŸ‘£ðŸ•‹ðŸ‘£âŒâŒðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£âŒ"
    , "âŒðŸ‘£ðŸ‘£ðŸ‘£âŒâŒðŸ‘£ðŸ•‹ðŸ‘£ðŸ•‹ðŸ‘£ðŸ•‹ðŸ‘£ðŸ•‹ðŸ‘£âŒ"
    , "âŒâŒâŒâŒâŒâŒðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£âŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    ]
        |> fromEmojis


stoneArea : List ( ( Int, Int ), Tile )
stoneArea =
    [ "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒðŸª¨ðŸª¨ðŸª¨ðŸª¨âŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒðŸª¨ðŸª¨âŒâŒâŒâŒâŒðŸª¨âŒâŒâŒâŒ"
    , "âŒâŒâŒðŸª¨âŒâŒâŒâŒâŒâŒâŒâŒðŸª¨âŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒðŸª¨âŒâŒâŒ"
    , "âŒâŒðŸª¨âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒðŸª¨âŒâŒ"
    , "âŒâŒðŸª¨âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒðŸª¨âŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±âŒâŒâŒâŒðŸª¨âŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±âŒâŒâŒâŒðŸª¨âŒâŒ"
    , "âŒâŒðŸª¨âŒâŒâŒâŒâŒâŒâŒâŒâŒðŸª¨âŒâŒâŒ"
    , "âŒâŒðŸª¨âŒâŒâŒâŒâŒâŒâŒâŒâŒðŸª¨âŒâŒâŒ"
    , "âŒâŒâŒðŸª¨âŒâŒâŒâŒâŒâŒâŒâŒðŸª¨âŒâŒâŒ"
    , "âŒâŒâŒðŸª¨âŒâŒâŒâŒâŒâŒâŒðŸª¨âŒâŒâŒâŒ"
    , "âŒâŒâŒâŒðŸª¨âŒâŒâŒâŒðŸª¨ðŸª¨âŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒðŸª¨ðŸª¨ðŸª¨ðŸª¨âŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    ]
        |> fromEmojis


transpose : ( Int, Int ) -> List ( ( Int, Int ), Tile ) -> List ( ( Int, Int ), Tile )
transpose ( x, y ) =
    List.map
        (Tuple.mapFirst
            (Tuple.mapBoth
                ((+) x)
                ((+) y)
            )
        )
