module Structure exposing (..)

import Dict exposing (Dict)
import Tile exposing (Obstacle(..), Tile(..))


fromEmojis : List String -> Dict ( Int, Int ) Tile
fromEmojis rows =
    rows
        |> List.indexedMap
            (\y row ->
                row
                    |> String.toList
                    |> List.indexedMap
                        (\x char ->
                            char
                                |> fromEmoji
                                |> Maybe.map (Tuple.pair ( x, y ))
                        )
                    |> List.filterMap identity
            )
        |> List.concat
        |> Dict.fromList


fromEmoji : Char -> Maybe Tile
fromEmoji char =
    case char of
        'ðŸª¨' ->
            Just (ObstacleTile Stone)

        'ðŸ•‹' ->
            Just (ObstacleTile Pole)

        'ðŸ‘£' ->
            Just Sand

        'ðŸŒ±' ->
            Just Gras

        'ðŸŒ³' ->
            Just Bonsai

        'âŒ' ->
            Nothing

        _ ->
            Nothing


startingArea : Dict ( Int, Int ) Tile
startingArea =
    [ "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£âŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒðŸ‘£ðŸ‘£ðŸŒ±ðŸŒ±ðŸŒ±ðŸ‘£ðŸ‘£âŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒðŸ‘£ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸ‘£âŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒðŸ‘£ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸ‘£âŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒðŸ‘£ðŸ‘£ðŸŒ±ðŸŒ±ðŸŒ±ðŸ‘£ðŸ‘£âŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£âŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    ]
        |> fromEmojis


grasArea : Dict ( Int, Int ) Tile
grasArea =
    [ "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒâŒ"
    , "âŒâŒðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒâŒðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒ"
    , "âŒâŒðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±ðŸŒ±âŒâŒ"
    , "âŒâŒðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±âŒâŒ"
    , "âŒâŒâŒðŸŒ±âŒâŒâŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±âŒâŒ"
    , "âŒâŒâŒðŸŒ±âŒâŒâŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±âŒâŒ"
    , "âŒâŒâŒðŸŒ±âŒâŒâŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±âŒâŒ"
    , "âŒâŒâŒðŸŒ±âŒâŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±âŒâŒâŒ"
    , "âŒâŒðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒ"
    , "âŒâŒðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒâŒðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒâŒ"
    , "âŒâŒðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒ"
    , "âŒâŒâŒðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    ]
        |> fromEmojis


grasBatches : Dict ( Int, Int ) Tile
grasBatches =
    [ "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒðŸŒ±âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒðŸŒ±âŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±âŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒ"
    , "âŒâŒâŒðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±âŒâŒâŒ"
    , "âŒâŒðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±âŒâŒâŒâŒðŸŒ±ðŸŒ±âŒâŒâŒâŒ"
    , "âŒâŒðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    ]
        |> fromEmojis


poleArea : Dict ( Int, Int ) Tile
poleArea =
    [ "ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£âŒâŒâŒâŒâŒâŒâŒ"
    , "ðŸ‘£ðŸ•‹ðŸ‘£ðŸ•‹ðŸ‘£ðŸ•‹ðŸ‘£ðŸ•‹ðŸ‘£âŒâŒâŒâŒâŒâŒâŒ"
    , "ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£âŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒðŸ‘£ðŸ‘£ðŸ‘£âŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒðŸ‘£ðŸ•‹ðŸ‘£âŒâŒ"
    , "âŒðŸ‘£ðŸ‘£ðŸ‘£âŒâŒâŒâŒâŒâŒâŒðŸ‘£ðŸ‘£ðŸ‘£âŒâŒ"
    , "âŒðŸ‘£ðŸ•‹ðŸ‘£âŒðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±âŒâŒðŸ‘£ðŸ•‹ðŸ‘£âŒâŒ"
    , "âŒðŸ‘£ðŸ‘£ðŸ‘£âŒðŸŒ±ðŸ•‹ðŸ•‹ðŸŒ±âŒâŒðŸ‘£ðŸ‘£ðŸ‘£âŒâŒ"
    , "âŒðŸ‘£ðŸ•‹ðŸ‘£âŒðŸŒ±ðŸ•‹ðŸ•‹ðŸŒ±âŒâŒðŸ‘£ðŸ•‹ðŸ‘£âŒâŒ"
    , "âŒðŸ‘£ðŸ‘£ðŸ‘£âŒðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ±âŒâŒðŸ‘£ðŸ‘£ðŸ‘£âŒâŒ"
    , "âŒðŸ‘£ðŸ•‹ðŸ‘£âŒâŒâŒâŒâŒâŒâŒðŸ‘£ðŸ•‹ðŸ‘£âŒâŒ"
    , "âŒðŸ‘£ðŸ‘£ðŸ‘£âŒâŒâŒâŒâŒâŒâŒðŸ‘£ðŸ‘£ðŸ‘£âŒâŒ"
    , "âŒðŸ‘£ðŸ•‹ðŸ‘£âŒâŒðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£âŒ"
    , "âŒðŸ‘£ðŸ‘£ðŸ‘£âŒâŒðŸ‘£ðŸ•‹ðŸ‘£ðŸ•‹ðŸ‘£ðŸ•‹ðŸ‘£ðŸ•‹ðŸ‘£âŒ"
    , "âŒâŒâŒâŒâŒâŒðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£âŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    ]
        |> fromEmojis
        |> Dict.insert ( 6, 7 ) Statue
        |> Dict.insert ( 7, 7 ) SolidPlaceholder
        |> Dict.insert ( 6, 8 ) SolidPlaceholder
        |> Dict.insert ( 7, 8 ) SolidPlaceholder


shrineArea : Dict ( Int, Int ) Tile
shrineArea =
    [ "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒðŸ•‹ðŸ•‹ðŸ•‹ðŸ•‹ðŸ•‹ðŸ•‹ðŸ•‹ðŸ•‹ðŸ•‹ðŸ•‹âŒâŒâŒâŒ"
    , "âŒâŒðŸ•‹âŒâŒâŒâŒâŒâŒâŒâŒðŸ•‹âŒâŒâŒâŒ"
    , "âŒâŒðŸ•‹âŒâŒâŒâŒâŒâŒâŒâŒðŸ•‹ðŸ•‹ðŸ•‹ðŸ•‹ðŸ•‹"
    , "âŒâŒðŸ•‹âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒðŸ•‹"
    , "âŒâŒðŸ•‹âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒðŸ•‹"
    , "âŒâŒðŸ•‹âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒðŸ•‹"
    , "âŒâŒðŸ•‹âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒðŸ•‹"
    , "âŒâŒðŸ•‹âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒðŸ•‹"
    , "âŒâŒðŸ•‹âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒðŸ•‹"
    , "âŒâŒðŸ•‹âŒâŒâŒâŒâŒðŸ•‹ðŸ•‹âŒâŒâŒâŒâŒðŸ•‹"
    , "âŒâŒðŸ•‹ðŸ•‹ðŸ•‹ðŸ•‹ðŸ•‹âŒðŸ•‹ðŸ•‹âŒðŸ•‹âŒðŸ•‹ðŸ•‹ðŸ•‹"
    , "âŒâŒâŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±âŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    ]
        |> fromEmojis
        |> Dict.insert ( 8, 12 ) Statue
        |> Dict.insert ( 9, 12 ) SolidPlaceholder
        |> Dict.insert ( 8, 13 ) SolidPlaceholder
        |> Dict.insert ( 9, 13 ) SolidPlaceholder


stoneArea : Dict ( Int, Int ) Tile
stoneArea =
    [ "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒðŸª¨ðŸª¨ðŸª¨ðŸª¨âŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒðŸª¨ðŸª¨âŒâŒâŒâŒâŒðŸª¨âŒâŒâŒâŒ"
    , "âŒâŒâŒðŸª¨âŒâŒâŒâŒâŒâŒâŒâŒðŸª¨âŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒðŸª¨âŒâŒâŒ"
    , "âŒâŒðŸª¨âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒðŸª¨âŒâŒ"
    , "âŒâŒðŸª¨âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒðŸª¨âŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±âŒâŒâŒâŒðŸª¨âŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒðŸŒ±ðŸŒ±âŒâŒâŒâŒðŸª¨âŒâŒ"
    , "âŒâŒðŸª¨âŒâŒâŒâŒâŒâŒâŒâŒâŒðŸª¨âŒâŒâŒ"
    , "âŒâŒðŸª¨âŒâŒâŒâŒâŒâŒâŒâŒâŒðŸª¨âŒâŒâŒ"
    , "âŒâŒâŒðŸª¨âŒâŒâŒâŒâŒâŒâŒâŒðŸª¨âŒâŒâŒ"
    , "âŒâŒâŒðŸª¨âŒâŒâŒâŒâŒâŒâŒðŸª¨âŒâŒâŒâŒ"
    , "âŒâŒâŒâŒðŸª¨âŒâŒâŒâŒðŸª¨ðŸª¨âŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒðŸª¨ðŸª¨ðŸª¨ðŸª¨âŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ"
    ]
        |> fromEmojis


smallGarden : Dict ( Int, Int ) Tile
smallGarden =
    [ "âŒâŒâŒâŒâŒðŸ‘£ðŸ‘£ðŸ‘£âŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒâŒâŒâŒðŸ‘£ðŸ‘£ðŸŒ³ðŸ‘£âŒâŒâŒâŒâŒâŒâŒâŒ"
    , "âŒðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£âŒâŒâŒâŒâŒâŒ"
    , "âŒðŸ‘£ðŸŒ³ðŸ‘£ðŸ‘£ðŸŒ³ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£âŒâŒâŒâŒ"
    , "âŒðŸª¨ðŸª¨ðŸª¨ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸŒ³ðŸ‘£ðŸª¨ðŸª¨ðŸª¨âŒ"
    , "âŒðŸª¨âŒðŸ‘£ðŸŒ³ðŸ‘£ðŸ‘£ðŸŒ³ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£âŒðŸª¨âŒ"
    , "âŒðŸª¨ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸŒ³ðŸ‘£âŒâŒâŒ"
    , "âŒðŸª¨ðŸ‘£ðŸŒ³ðŸ‘£ðŸ‘£ðŸ‘£ðŸŒ±ðŸŒ±ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£âŒâŒ"
    , "âŒâŒðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸŒ±ðŸŒ±ðŸŒ±ðŸŒ³ðŸ‘£ðŸ‘£ðŸŒ³ðŸ‘£âŒâŒ"
    , "âŒâŒâŒðŸ‘£ðŸŒ³ðŸ‘£ðŸŒ±ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£"
    , "âŒâŒâŒðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸŒ³ðŸ‘£ðŸ‘£ðŸ‘£ðŸŒ³ðŸ‘£"
    , "âŒðŸª¨ðŸ‘£ðŸ‘£ðŸ‘£ðŸŒ±ðŸ‘£ðŸ‘£ðŸŒ³ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸª¨ðŸ‘£"
    , "âŒðŸª¨ðŸ‘£ðŸŒ³ðŸ‘£ðŸ‘£ðŸŒ³ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸŒ³ðŸ‘£ðŸŒ³ðŸª¨âŒ"
    , "âŒðŸª¨ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸŒ³ðŸ‘£ðŸ‘£ðŸ‘£ðŸ‘£ðŸª¨âŒ"
    , "âŒðŸª¨ðŸª¨ðŸª¨ðŸ‘£ðŸ‘£ðŸ‘£ðŸŒ³ðŸ‘£ðŸ‘£ðŸ‘£âŒðŸ‘£ðŸŒ³ðŸ‘£âŒ"
    , "âŒâŒâŒâŒâŒâŒðŸ‘£ðŸ‘£ðŸ‘£âŒâŒâŒðŸ‘£ðŸ‘£ðŸ‘£âŒ"
    ]
        |> fromEmojis


transpose : ( Int, Int ) -> Dict ( Int, Int ) Tile -> List ( ( Int, Int ), Tile )
transpose ( x, y ) dict =
    dict
        |> Dict.toList
        |> List.map
            (Tuple.mapFirst
                (Tuple.mapBoth
                    ((+) x)
                    ((+) y)
                )
            )
